import{y as R,z,B,A as N,o as u,c as d,d as t,k as g,a as w,w as M,F as j,m as E,t as k,e as _,T as K,f as $,v as D,C as O,x as C,r as n,p as G,D as H}from"./app-BX5kK8gL.js";const U={class:"relative"},q=["value","placeholder"],J={class:"absolute right-3 top-2.5"},P={key:0,class:"animate-spin h-3 w-3 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Q={key:0,class:"absolute z-[100] mt-1 max-h-48 w-full overflow-auto rounded border border-gray-200 bg-white py-0 text-sm shadow-lg focus:outline-none"},W=["onClick"],X={class:"text-xs uppercase tracking-wider"},Y=["onClick"],Z={key:0,class:"fixed inset-0 z-[110] flex items-center justify-center bg-gray-900/40 backdrop-blur-[2px] p-4 text-left"},ee={class:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-6 leading-relaxed"},te={class:"space-y-1 mb-8"},ae={class:"flex gap-4"},oe=["disabled"],le={__name:"SmartSpecInput",props:{modelValue:String,categoryId:[Number,String],placeholder:{type:String,default:"Select or type specification..."}},emits:["update:modelValue"],setup(p,{emit:A}){const r=p,v=A,i=n([]),c=n(!1),m=n(!1),f=n(null),y=n(null),o=n(null),s=n(""),V=async()=>{if(!r.categoryId){i.value=[];return}m.value=!0;try{const e=await C.get(route("api.categories.spec-templates",r.categoryId));i.value=e.data}catch{console.error("Failed to fetch spec templates")}finally{m.value=!1}},I=e=>{o.value=e,s.value=e,c.value=!1,H(()=>{y.value?.focus()})},b=async()=>{if(!(!s.value||s.value===o.value))try{await C.post(route("api.categories.rename-spec-template",r.categoryId),{old_key:o.value,new_key:s.value});const e=i.value.indexOf(o.value);e!==-1&&(i.value[e]=s.value),r.modelValue===o.value&&v("update:modelValue",s.value),o.value=null}catch(e){alert("Failed to rename template: "+(e.response?.data?.message||e.message))}},x=G(()=>{if(!r.modelValue)return i.value;const e=r.modelValue.toLowerCase();return i.value.filter(a=>a.toLowerCase().includes(e))});R(()=>r.categoryId,()=>{V()},{immediate:!0});const F=e=>{v("update:modelValue",e),c.value=!1},L=e=>{v("update:modelValue",e.target.value),c.value=!0},h=e=>{f.value&&!f.value.contains(e.target)&&(c.value=!1)};return z(()=>{document.addEventListener("click",h)}),B(()=>{document.removeEventListener("click",h)}),(e,a)=>{const S=N("InputLabel");return u(),d("div",{class:"relative w-full",ref_key:"containerRef",ref:f},[t("div",U,[t("input",{type:"text",value:p.modelValue,onInput:L,onFocus:a[0]||(a[0]=l=>c.value=!0),class:"block w-full rounded border-gray-300 bg-white px-3 py-2 text-sm transition-all focus:border-[#1FA6A0] focus:ring-0 focus:bg-white",placeholder:p.placeholder},null,40,q),t("div",J,[m.value?(u(),d("svg",P,[...a[4]||(a[4]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):g("",!0)])]),w(K,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:M(()=>[c.value&&x.value.length>0?(u(),d("ul",Q,[(u(!0),d(j,null,E(x.value,l=>(u(),d("li",{key:l,class:"group relative flex items-center justify-between cursor-pointer select-none px-4 py-2.5 hover:bg-gray-50 hover:text-[#1FA6A0] font-bold transition-colors border-b border-gray-50 last:border-none",onClick:T=>F(l)},[t("span",X,k(l),1),t("button",{onClick:_(T=>I(l),["stop"]),class:"hidden group-hover:flex items-center justify-center p-1 rounded border border-gray-200 text-gray-400 hover:bg-white hover:text-[#1FA6A0] transition-all",title:"Rename Global Template"},[...a[5]||(a[5]=[t("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])],8,Y)],8,W))),128))])):g("",!0)]),_:1}),o.value?(u(),d("div",Z,[t("div",{class:"w-full max-w-sm rounded bg-white p-8 shadow-2xl border border-gray-200",onClick:a[3]||(a[3]=_(()=>{},["stop"]))},[a[6]||(a[6]=t("h4",{class:"text-xs font-black uppercase tracking-[0.2em] text-gray-900 mb-2"},"Global Template Refactor",-1)),t("p",ee,'Renaming "'+k(o.value)+'" will affect the master registry for this category.',1),t("div",te,[w(S,{value:"New Template Label",class:"text-[10px] font-black uppercase text-gray-500"}),$(t("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>s.value=l),type:"text",class:"block w-full rounded border-gray-300 px-3 py-2 text-sm font-bold shadow-none focus:border-[#1FA6A0] focus:ring-0",placeholder:"Enter new label name...",onKeyup:O(b,["enter"]),ref_key:"renameInput",ref:y},null,544),[[D,s.value]])]),t("div",ae,[t("button",{onClick:a[2]||(a[2]=l=>o.value=null),class:"flex-1 rounded border border-gray-200 bg-white py-3 text-[10px] font-black uppercase tracking-widest text-gray-400 hover:bg-gray-50 transition-colors"}," Abort "),t("button",{onClick:b,disabled:!s.value||s.value===o.value,class:"flex-1 rounded bg-[#1FA6A0] py-3 text-[10px] font-black uppercase tracking-widest text-white hover:bg-[#168C87] disabled:opacity-50 transition-colors shadow-lg shadow-[#1FA6A0]/20"}," Confirm Change ",8,oe)])])])):g("",!0)],512)}}};export{le as _};
