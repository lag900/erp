import{u as e,o as s,a as r,k as t,m as a,p as i,w as l,b as o,q as n,t as d,F as c,z as u,d as p,e as m,c as g,g as x,y as h,A as f}from"./vendor-DGI0tb4d.js";import{_ as v}from"./AuthenticatedLayout-DmLSy_bE.js";import{_ as y}from"./app-8mzpaiXE.js";import{_ as b}from"./TextInput-7Tb4wL4u.js";import{_ as w}from"./InputLabel-ttg1gjZN.js";import{_ as k}from"./InputError-CSjO0CYp.js";import{G as _}from"./GlobalCheckbox-BSagvGQB.js";import"./utils-B98O4e5m.js";/* empty css                                                              */import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./DangerButton-Bzsvvehx.js";import"./SecondaryButton-DsdD6xme.js";const j={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},C={class:"py-10"},P={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},L={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white p-8 shadow-premium"},U={class:"max-w-md"},B={class:"space-y-6"},z={class:"flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between px-2"},S={class:"flex items-center gap-6 bg-white px-6 py-3 rounded-2xl border border-gray-100 shadow-soft"},V={class:"flex items-center gap-3"},A={class:"text-[10px] font-bold text-gray-400 uppercase tracking-tighter"},G={class:"relative w-full sm:w-80"},I={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 text-start"},M={class:"flex items-center justify-between border-b border-gray-100 bg-gray-50/50 px-6 py-4"},E={class:"flex items-center gap-3"},R={class:"text-xs font-black uppercase tracking-widest text-gray-900"},T={class:"text-[9px] font-bold uppercase text-gray-400"},D={class:"flex-1 space-y-1 p-4"},q=["for"],F={class:"block text-sm font-bold text-gray-700 group-hover:text-primary transition-colors"},N={class:"block text-[8px] font-black uppercase text-gray-300 tracking-widest leading-none"},H={key:0,class:"mt-12 bg-gray-50/50 rounded-3xl p-8 border border-dashed border-gray-200 text-start"},K={class:"flex items-center gap-3 mb-6 px-2"},J={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},O=["for"],Q={class:"text-xs font-bold text-gray-600 tracking-tight"},W={class:"sticky bottom-8 flex items-center justify-between rounded-2xl border border-gray-200 bg-white shadow-2xl p-6 ring-1 ring-black/5"},X={class:"flex items-center gap-4 text-sm font-bold text-gray-500"},Y={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gray-100 text-gray-900 border border-gray-200"},Z={class:"flex gap-3"},$={__name:"Create",props:{groups:Array,ungrouped:Array},setup($){const ee=$,se=()=>{ie.post(route("roles.store"),{onSuccess:()=>{window.showToast&&window.showToast("success","Security Persona established successfully.")}})},re=h(""),te=f(),ae=x(()=>te.props.auth?.permissions??[]),ie=e({name:"",permission_ids:[]}),le=x(()=>{const e=re.value.trim().toLowerCase();return ee.groups.map(s=>{const r=s.permissions.filter(s=>s.name.toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e));return{...s,matchedPerms:r}}).filter(e=>e.matchedPerms.length>0)}),oe=x(()=>{const e=re.value.trim().toLowerCase();return ee.ungrouped.filter(s=>s.name.toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e))}),ne=e=>{const s=e.map(e=>e.id);if(s.every(e=>ie.permission_ids.includes(e)))ie.permission_ids=ie.permission_ids.filter(e=>!s.includes(e));else{const e=s.filter(e=>!ie.permission_ids.includes(e));ie.permission_ids=[...ie.permission_ids,...e]}},de=e=>e.length>0&&e.every(e=>ie.permission_ids.includes(e.id)),ce=e=>{const s=e.filter(e=>ie.permission_ids.includes(e.id)).length;return s>0&&s<e.length},ue=x(()=>{const e=[];return ee.groups.forEach(s=>e.push(...s.permissions)),e.push(...ee.ungrouped),e}),pe=x(()=>ue.value.length>0&&ue.value.every(e=>ie.permission_ids.includes(e.id))),me=x(()=>{const e=ue.value.filter(e=>ie.permission_ids.includes(e.id)).length;return e>0&&e<ue.value.length}),ge=()=>{pe.value?ie.permission_ids=[]:ie.permission_ids=ue.value.map(e=>e.id)};return(e,x)=>(s(),r(c,null,[t(a(i),{title:"Establish New Role Identity"}),t(v,null,{header:l(()=>[o("div",j,[x[7]||(x[7]=o("div",null,[o("h2",{class:"text-2xl font-bold leading-tight text-gray-800"}," New Security Persona "),o("p",{class:"mt-1 text-sm text-gray-500"},"Define a new functional identity and its operational boundaries.")],-1)),t(y,{href:e.route("roles.index"),variant:"secondary"},{icon:l(()=>[...x[5]||(x[5]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),default:l(()=>[x[6]||(x[6]=m(" Back to Registry ",-1))]),_:1},8,["href"])])]),default:l(()=>{return[o("div",C,[o("div",P,[o("form",{class:"space-y-8",onSubmit:n(se,["prevent"])},[o("div",L,[x[8]||(x[8]=o("div",{class:"flex items-center gap-4 mb-6"},[o("div",{class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary"},[o("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])]),o("div",null,[o("h3",{class:"text-lg font-bold text-gray-900 uppercase tracking-tighter"},"Persona Core"),o("p",{class:"text-xs text-gray-400"},"Provide a unique designation for this operational role.")])],-1)),o("div",U,[t(w,{for:"name",value:"Role Designation",class:"text-xs font-black uppercase tracking-widest text-gray-500 mb-2"}),t(b,{id:"name",modelValue:a(ie).name,"onUpdate:modelValue":x[0]||(x[0]=e=>a(ie).name=e),class:"block w-full border-gray-200 focus:border-primary focus:ring-primary h-12 rounded-xl shadow-soft",placeholder:"e.g., Inventory Auditor",autofocus:""},null,8,["modelValue"]),t(k,{class:"mt-2",message:a(ie).errors.name},null,8,["message"])])]),o("div",B,[o("div",z,[o("div",S,[o("div",V,[t(_,{id:"global-select-all",checked:pe.value,indeterminate:me.value,"onUpdate:checked":ge},null,8,["checked","indeterminate"]),x[9]||(x[9]=o("label",{for:"global-select-all",class:"text-xs font-black uppercase tracking-widest text-gray-900 cursor-pointer select-none"}," Global Selector ",-1))]),x[10]||(x[10]=o("div",{class:"h-4 w-px bg-gray-200"},null,-1)),o("div",A,d(a(ie).permission_ids.length)+" / "+d(ue.value.length)+" Gates Enabled ",1)]),o("div",G,[x[11]||(x[11]=o("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[o("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),t(b,{modelValue:re.value,"onUpdate:modelValue":x[1]||(x[1]=e=>re.value=e),class:"block w-full border-gray-200 pl-10 h-11 rounded-xl text-sm transition-all focus:ring-primary/20 shadow-soft",placeholder:"Search authorization keys..."},null,8,["modelValue"])])]),o("div",I,[(s(!0),r(c,null,u(le.value,e=>(s(),r("div",{key:e.id,class:"group relative flex flex-col overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-soft transition-all duration-300 hover:border-primary/20 hover:shadow-lg"},[o("div",M,[o("div",E,[t(_,{id:"group-"+e.id,checked:de(e.matchedPerms),indeterminate:ce(e.matchedPerms),"onUpdate:checked":s=>ne(e.matchedPerms)},null,8,["id","checked","indeterminate","onUpdate:checked"]),o("h4",R,d(e.name),1)]),o("span",T,d(e.matchedPerms.length)+" Keys ",1)]),o("div",D,[(s(!0),r(c,null,u(e.matchedPerms,e=>(s(),r("div",{key:e.id,class:"flex items-center justify-between rounded-xl px-3 py-2.5 transition-all hover:bg-gray-50 group/item"},[o("label",{for:"perm-"+e.id,class:"flex cursor-pointer items-center gap-4 flex-1"},[t(_,{id:"perm-"+e.id,checked:a(ie).permission_ids,"onUpdate:checked":x[2]||(x[2]=e=>a(ie).permission_ids=e),value:e.id},null,8,["id","checked","value"]),o("div",null,[o("span",F,d(e.name.split("-").join(" ")),1),o("span",N,d(e.name),1)])],8,q)]))),128))])]))),128))]),oe.value.length>0?(s(),r("div",H,[o("div",K,[t(_,{id:"group-ungrouped",checked:de(oe.value),indeterminate:ce(oe.value),"onUpdate:checked":x[3]||(x[3]=e=>ne(oe.value))},null,8,["checked","indeterminate"]),x[12]||(x[12]=o("h4",{class:"text-xs font-black uppercase tracking-[0.3em] text-gray-400"},"Legacy / Uncategorized Gates",-1))]),o("div",J,[(s(!0),r(c,null,u(oe.value,e=>(s(),r("div",{key:e.id,class:"flex items-center justify-between rounded-2xl bg-white border border-gray-100 p-4 transition-all hover:border-primary/30"},[o("label",{for:"perm-un-"+e.id,class:"flex cursor-pointer items-center justify-between w-full"},[o("span",Q,d(e.name),1),t(_,{id:"perm-un-"+e.id,checked:a(ie).permission_ids,"onUpdate:checked":x[4]||(x[4]=e=>a(ie).permission_ids=e),value:e.id},null,8,["id","checked","value"])],8,O)]))),128))])])):p("",!0),t(k,{class:"mt-2",message:a(ie).errors.permission_ids},null,8,["message"])]),o("div",W,[o("div",X,[o("span",Y,d(a(ie).permission_ids.length),1),x[13]||(x[13]=m(" Permissions Bound ",-1))]),o("div",Z,[(e="role-create",ae.value.includes(e)?(s(),g(y,{key:0,type:"submit",variant:"primary",processing:a(ie).processing,class:"min-w-[160px]"},{icon:l(()=>[...x[14]||(x[14]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])]),default:l(()=>[x[15]||(x[15]=m(" Finalize Role ",-1))]),_:1},8,["processing"])):p("",!0))])])],32)])])];var e}),_:1})],64))}};export{$ as default};
