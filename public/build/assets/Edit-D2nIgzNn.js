import{u as Q,y as H,z as W,r as y,x as j,A as X,o as i,c as n,a as o,b as u,h as Y,w as v,d as e,e as Z,f as k,F as h,m as b,t as g,g as N,v as B,k as C,n as q,l as L,i as V,p as ee}from"./app-BX5kK8gL.js";import{_ as te}from"./AuthenticatedLayout-WTG0r7J_.js";import{P as R}from"./PrimaryButton-C8C6_QA7.js";import{_ as se}from"./SecondaryButton-CW323Hov.js";import{_ as I}from"./TextInput-D8M23_PG.js";import{_ as $}from"./InputError-C8hi-McE.js";import{S as D}from"./SearchableSelect-DdQP9iMn.js";import{_ as ae}from"./SmartSpecInput-BvGBkep5.js";import{_ as oe}from"./DangerButton-Doqh3QbT.js";import"./browser-image-compression-DILJcqf6.js";import{d as le}from"./debounce-BXMWmS25.js";/* empty css                                                              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./debounce-CndEhmqu.js";const re={class:"flex items-center justify-between"},ie={class:"flex items-center gap-4"},ne={class:"flex flex-col"},de={class:"flex items-center gap-3 mt-0.5"},ue={class:"text-[10px] text-gray-500 font-bold uppercase tracking-tight"},ce={class:"text-primary font-mono tracking-normal"},pe={key:0,class:"flex items-center gap-1.5 px-2 py-0.5 rounded-md bg-primary/10 border border-primary/20"},ge={class:"text-[9px] font-black text-primary uppercase tracking-tighter"},me={class:"py-6"},ye={class:"mx-auto max-w-5xl px-4"},fe={class:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden"},ve={class:"p-8 grid grid-cols-1 md:grid-cols-2 gap-8"},xe={class:"md:col-span-2 space-y-2"},he={class:"space-y-2"},be=["value"],we={class:"space-y-2"},_e={class:"md:col-span-2 space-y-2"},ke={class:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden"},Ce={class:"px-6 py-4 border-b border-gray-50 bg-gray-900 text-white flex items-center justify-between"},Ve={class:"p-8 space-y-8"},Se={class:"relative max-w-xl mx-auto"},Me={key:0,class:"absolute right-4 top-10"},Ae={key:1,class:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl border border-gray-100 shadow-2xl z-50 p-2 overflow-hidden"},Ue=["onClick"],je={class:"text-xs font-bold text-gray-900 font-mono"},Ie={class:"text-[10px] uppercase font-black text-gray-400 tracking-tight"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},He={key:0,class:"md:col-span-2 py-12 text-center border-2 border-dashed border-gray-50 rounded-3xl"},Ne={class:"flex items-center gap-4"},$e={class:"text-sm font-bold text-gray-900 font-mono group-hover:text-primary transition-colors"},Be={class:"text-[10px] text-gray-400 font-black uppercase tracking-widest mt-0.5"},Le={key:0,class:"mt-1 flex flex-wrap gap-1"},Re={class:"flex items-center gap-4"},De=["onClick"],Ee={class:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden"},Fe={class:"p-8 space-y-4"},Oe=["onClick"],Pe={class:"space-y-2"},ze={class:"space-y-2"},Ke={class:"flex items-center justify-between py-8 border-t border-gray-100"},Ge={class:"flex gap-4"},Je={class:"p-8"},Qe={class:"mb-8"},We={class:"text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1"},Xe={class:"space-y-6"},Ye={class:"grid grid-cols-1 gap-6"},Ze={class:"space-y-2"},qe={class:"space-y-2"},et={class:"space-y-1"},tt={class:"space-y-1"},st={class:"space-y-2"},at={class:"mt-10 pt-6 border-t border-gray-50 flex gap-4"},xt={__name:"Edit",props:{asset:{type:Object,required:!0},rooms:{type:Array,default:()=>[]},classifications:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},subCategories:{type:Array,default:()=>[]},departments:{type:Array,default:()=>[]}},setup(m){const d=m,l=Q({room_id:d.asset.room_id,category_id:d.asset.category_id,sub_category_id:d.asset.sub_category_id,count:d.asset.count??1,note:d.asset.note??"",status:d.asset.status??"active",is_shared:!!d.asset.is_shared,shared_department_ids:d.asset.shared_department_ids??[],infos:d.asset.infos?.length?d.asset.infos.map(a=>({id:a.id,key:a.key,value:a.value??"",image:null,image_url:a.image_url??null})):[{key:"",value:"",image:null,image_url:null}]}),S=y("");H(S,a=>{if(a){const[t,r]=a.split(":");l.category_id=parseInt(t),l.sub_category_id=r?parseInt(r):""}else l.category_id="",l.sub_category_id=""}),W(()=>{if(l.category_id){const a=d.classifications.find(t=>t.category_id===l.category_id&&t.sub_category_id===(l.sub_category_id||null));a&&(S.value=a.id)}});const E=ee(()=>l.category_id),F=()=>{l.infos.push({key:"",value:"",image:null,image_url:null})},O=a=>{if(l.infos.length===1){l.infos[0]={key:"",value:"",image:null,image_url:null};return}l.infos.splice(a,1)},x=y([...d.asset.components||[]]),w=y(!1),M=y(!1),A=y(""),_=y([]),T=y(!1),c=y({category_id:"",sub_category_id:"",status:"active",note:"",infos:[{key:"Serial No",value:""}]}),U=y("");H(U,a=>{if(a){const[t,r]=a.split(":");c.value.category_id=parseInt(t),c.value.sub_category_id=r?parseInt(r):""}else c.value.category_id="",c.value.sub_category_id=""});const P=le(async a=>{if(!a||a.length<2){_.value=[];return}T.value=!0;try{const t=await j.get(route("api.assets.search"),{params:{search:a,exclude_id:d.asset.id}});_.value=t.data.filter(r=>!x.value.some(s=>s.id===r.id))}catch(t){console.error(t)}finally{T.value=!1}},300);H(A,P);const z=async a=>{try{await j.post(route("assets.attach",d.asset.id),{child_id:a.id}),x.value.push({id:a.id,asset_code:a.asset_code,name:a.name,status:"active"}),A.value="",_.value=[],window.showToast&&window.showToast("success","Hardware attached")}catch{window.showToast&&window.showToast("error","Failed to attach")}},K=async()=>{if(!c.value.category_id){window.showToast&&window.showToast("error","Select classification");return}const a=c.value.infos.filter(t=>t.key&&t.key.trim()!==""&&t.value&&t.value.trim()!=="");M.value=!0;try{const t={...c.value,infos:a},r=await j.post(route("assets.components.store",d.asset.id),t);x.value.push(r.data),w.value=!1,U.value="",c.value={category_id:"",sub_category_id:"",status:"active",note:"",infos:[{key:"Serial No",value:""}]},window.showToast&&window.showToast("success","New component registered")}catch{window.showToast&&window.showToast("error","Registration failed")}finally{M.value=!1}},G=async a=>{try{await j.delete(route("assets.detach",d.asset.id),{data:{child_id:a}}),x.value=x.value.filter(t=>t.id!==a),window.showToast&&window.showToast("success","Hardware detached")}catch{window.showToast&&window.showToast("error","Failed to detach")}},J={active:"bg-green-50 text-green-700",maintenance:"bg-blue-50 text-blue-700",damaged:"bg-red-50 text-red-700",retired:"bg-gray-50 text-gray-500"};return(a,t)=>{const r=X("InputLabel");return i(),n(h,null,[o(u(Y),{title:"Edit Hardware System"}),o(te,null,{header:v(()=>[e("div",re,[e("div",ie,[o(u(L),{href:a.route("assets.show",m.asset.id),class:"flex h-10 w-10 items-center justify-center rounded-xl border border-gray-200 bg-white text-gray-400 transition-all hover:bg-gray-50 hover:text-primary shadow-soft"},{default:v(()=>[...t[12]||(t[12]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1},8,["href"]),e("div",ne,[t[14]||(t[14]=e("h2",{class:"text-xl font-bold text-gray-900"},"Modify Hardware System",-1)),e("div",de,[e("p",ue,[t[13]||(t[13]=V("Enterprise Index: ",-1)),e("span",ce,g(m.asset.asset_code),1)]),m.asset.bundle_serial?(i(),n("div",pe,[e("span",ge,"Serial: "+g(m.asset.bundle_serial),1)])):C("",!0)])])])])]),default:v(()=>[e("div",me,[e("div",ye,[e("form",{onSubmit:t[6]||(t[6]=Z(s=>u(l).transform(p=>({...p,_method:"put"})).post(a.route("assets.update",m.asset.id),{forceFormData:!0}),["prevent"])),class:"space-y-6"},[e("div",fe,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-50 bg-gray-50/20"},[e("h3",{class:"text-[10px] font-black uppercase tracking-widest text-gray-400"},"Environment & Custody")],-1)),e("div",ve,[e("div",xe,[o(D,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=s=>S.value=s),options:m.classifications,label:"Asset Classification",placeholder:"Search classification (e.g. Computers - DELL)",class:"w-full"},null,8,["modelValue","options"]),o($,{message:u(l).errors.category_id},null,8,["message"]),o($,{message:u(l).errors.sub_category_id},null,8,["message"])]),e("div",he,[o(r,{for:"room_id",value:"Stationed Room",class:"!text-[9px] !font-black !uppercase !text-gray-400"}),k(e("select",{id:"room_id","onUpdate:modelValue":t[1]||(t[1]=s=>u(l).room_id=s),class:"w-full h-12 rounded-xl border-gray-100 bg-gray-50 text-sm focus:bg-white transition-all"},[t[15]||(t[15]=e("option",{value:"",disabled:""},"Choose Placement",-1)),(i(!0),n(h,null,b(m.rooms,s=>(i(),n("option",{key:s.id,value:s.id},g(s.label),9,be))),128))],512),[[N,u(l).room_id]]),o($,{message:u(l).errors.room_id},null,8,["message"])]),e("div",we,[o(r,{for:"status",value:"Operational Health",class:"!text-[9px] !font-black !uppercase !text-gray-400"}),k(e("select",{id:"status","onUpdate:modelValue":t[2]||(t[2]=s=>u(l).status=s),class:"w-full h-12 rounded-xl border-gray-100 bg-gray-50 text-sm focus:bg-white transition-all"},[...t[16]||(t[16]=[e("option",{value:"active"},"Operational (Active)",-1),e("option",{value:"maintenance"},"Under Service",-1),e("option",{value:"damaged"},"Faulty / Broken",-1),e("option",{value:"retired"},"Out of Service",-1)])],512),[[N,u(l).status]])]),e("div",_e,[o(r,{for:"note",value:"Administrative Remarks",class:"!text-[9px] !font-black !uppercase !text-gray-400"}),k(e("textarea",{id:"note","onUpdate:modelValue":t[3]||(t[3]=s=>u(l).note=s),rows:"2",class:"w-full rounded-xl border-gray-100 bg-gray-50 text-sm focus:bg-white transition-all p-4",placeholder:"Provide context for registry changes..."},null,512),[[B,u(l).note]])])])]),e("div",ke,[e("div",Ce,[t[18]||(t[18]=e("div",null,[e("h3",{class:"text-xs font-black uppercase tracking-widest text-white/70"},"Hardware System Composition"),e("p",{class:"text-[9px] font-bold text-primary uppercase mt-0.5"},"Manage sub-items linked to this serial")],-1)),e("button",{type:"button",onClick:t[4]||(t[4]=s=>w.value=!0),class:"text-[10px] font-black uppercase tracking-widest px-4 py-2 bg-primary rounded-xl text-white shadow-lg active:scale-95 transition-all"},"+ Register New Item")]),e("div",Ve,[e("div",Se,[o(r,{value:"Attach Existing Hardware",class:"text-center !text-[9px] !font-black !uppercase !text-gray-400 !mb-3"}),o(I,{modelValue:A.value,"onUpdate:modelValue":t[5]||(t[5]=s=>A.value=s),type:"text",placeholder:"Search Serial or Label to link...",class:"w-full !h-12 !bg-gray-50 !border-gray-100 !rounded-xl text-center !text-sm"},null,8,["modelValue"]),T.value?(i(),n("div",Me,[...t[19]||(t[19]=[e("svg",{class:"h-4 w-4 animate-spin text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])):C("",!0),_.value.length>0?(i(),n("div",Ae,[(i(!0),n(h,null,b(_.value,s=>(i(),n("button",{key:s.id,type:"button",onClick:p=>z(s),class:"flex w-full items-center justify-between p-4 rounded-xl hover:bg-gray-50 transition-colors text-left group"},[e("div",null,[e("p",je,g(s.asset_code),1),e("p",Ie,g(s.name),1)]),t[20]||(t[20]=e("span",{class:"text-[10px] font-black text-primary uppercase opacity-0 group-hover:opacity-100"},"Attach +",-1))],8,Ue))),128))])):C("",!0)]),e("div",Te,[x.value.length===0?(i(),n("div",He,[...t[21]||(t[21]=[e("div",{class:"inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-gray-50 text-gray-300 mb-4"},[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1),e("p",{class:"text-sm text-gray-400 font-medium italic"},"Standalone system. No peripheral hardware attached.",-1)])])):C("",!0),(i(!0),n(h,null,b(x.value,s=>(i(),n("div",{key:s.id,class:"p-5 rounded-2xl border border-gray-50 bg-gray-50/30 flex items-center justify-between group hover:bg-white hover:shadow-soft transition-all"},[e("div",Ne,[t[22]||(t[22]=e("div",{class:"h-12 w-12 rounded-xl bg-white shadow-sm flex items-center justify-center text-gray-300"},[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})])],-1)),e("div",null,[e("p",$e,g(s.asset_code||"NO-CODE"),1),e("p",Be,g(s.name||"Missing Name"),1),s.infos&&s.infos.length?(i(),n("div",Le,[(i(!0),n(h,null,b(s.infos,p=>(i(),n("span",{key:p.key,class:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[8px] font-medium bg-gray-100 text-gray-500"},g(p.key||"Missing")+": "+g(p.value||"Data"),1))),128))])):C("",!0)])]),e("div",Re,[e("span",{class:q(["px-2.5 py-1 rounded-lg text-[9px] font-black uppercase",J[s.status]||"bg-gray-100"])},g(s.status),3),e("button",{type:"button",onClick:p=>G(s.id),class:"p-2 rounded-xl text-gray-300 hover:text-red-500 hover:bg-red-50 transition-all opacity-0 group-hover:opacity-100"},[...t[23]||(t[23]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,De)])]))),128))])])]),e("div",Ee,[e("div",{class:"px-6 py-4 border-b border-gray-50 bg-gray-50/20 flex items-center justify-between"},[t[24]||(t[24]=e("h3",{class:"text-[10px] font-black uppercase tracking-widest text-gray-400"},"Index Specifications",-1)),e("button",{type:"button",onClick:F,class:"text-[9px] font-black text-primary uppercase tracking-widest"},"+ Append Data Point")]),e("div",Fe,[(i(!0),n(h,null,b(u(l).infos,(s,p)=>(i(),n("div",{key:p,class:"relative p-6 rounded-2xl border border-gray-50 bg-gray-50/10 group grid grid-cols-1 md:grid-cols-2 gap-6"},[e("button",{type:"button",onClick:f=>O(p),class:"absolute -top-3 -right-3 h-8 w-8 rounded-xl bg-red-50 text-red-500 border border-red-100 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all shadow-sm"},[...t[25]||(t[25]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Oe),e("div",Pe,[o(r,{value:"Key Identity",class:"!text-[8px] !font-black !uppercase !text-gray-400"}),o(ae,{modelValue:s.key,"onUpdate:modelValue":f=>s.key=f,"category-id":E.value,class:"w-full !h-11 !text-sm !bg-white !rounded-xl",placeholder:"e.g. Serial, Model..."},null,8,["modelValue","onUpdate:modelValue","category-id"])]),e("div",ze,[o(r,{value:"Data Value",class:"!text-[8px] !font-black !uppercase !text-gray-400"}),o(I,{modelValue:s.value,"onUpdate:modelValue":f=>s.value=f,class:"w-full !h-11 !text-sm !bg-white !rounded-xl",placeholder:"Registry value..."},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),e("div",Ke,[t[28]||(t[28]=e("p",{class:"text-[10px] text-gray-400 font-bold uppercase tracking-tight italic leading-relaxed"},"System update will be strictly logged under your administrator profile.",-1)),e("div",Ge,[o(u(L),{href:a.route("assets.show",m.asset.id),class:"px-8 py-3 text-xs font-black text-gray-400 uppercase tracking-[0.2em] hover:text-gray-900 transition-colors"},{default:v(()=>[...t[26]||(t[26]=[V("Discard Changes",-1)])]),_:1},8,["href"]),o(R,{disabled:u(l).processing,class:"!h-12 !px-10 !rounded-xl !shadow-xl active:scale-95 transition-all"},{default:v(()=>[...t[27]||(t[27]=[V("Commit Full Profile Update",-1)])]),_:1},8,["disabled"])])])],32)])]),o(oe,{show:w.value,onClose:t[11]||(t[11]=s=>w.value=!1),"max-width":"lg"},{default:v(()=>[e("div",Je,[e("div",Qe,[t[29]||(t[29]=e("h3",{class:"text-xl font-black text-gray-900"},"Register New Hardware",-1)),e("p",We,"Add peripheral to system serial "+g(m.asset.asset_code),1)]),e("div",Xe,[e("div",Ye,[e("div",Ze,[o(D,{modelValue:U.value,"onUpdate:modelValue":t[7]||(t[7]=s=>U.value=s),options:m.classifications,label:"Component Classification",placeholder:"Search classification...",class:"w-full"},null,8,["modelValue","options"])]),e("div",qe,[o(r,{value:"Lifecycle Status",class:"!text-[9px] !font-black !uppercase !text-gray-400"}),k(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>c.value.status=s),class:"w-full h-12 rounded-xl border-gray-100 bg-gray-50 text-sm focus:bg-white transition-all"},[...t[30]||(t[30]=[e("option",{value:"active"},"Active",-1),e("option",{value:"maintenance"},"Maintenance",-1),e("option",{value:"damaged"},"Damaged",-1)])],512),[[N,c.value.status]])])]),(i(!0),n(h,null,b(c.value.infos,(s,p)=>(i(),n("div",{key:p,class:"grid grid-cols-2 gap-4"},[e("div",et,[o(I,{modelValue:s.key,"onUpdate:modelValue":f=>s.key=f,class:"w-full !h-10 border-gray-50 !bg-gray-100/50 !text-xs font-bold",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),e("div",tt,[o(I,{modelValue:s.value,"onUpdate:modelValue":f=>s.value=f,class:"w-full !h-10 !text-sm border-gray-100",placeholder:"Enter Serial / Label..."},null,8,["modelValue","onUpdate:modelValue"])])]))),128)),e("div",st,[o(r,{value:"Technician Notes",class:"!text-[9px] !font-black !uppercase !text-gray-400"}),k(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>c.value.note=s),rows:"2",class:"w-full rounded-xl border-gray-100 bg-gray-50 text-sm p-4 h-24",placeholder:"Optional notes for this specific part..."},null,512),[[B,c.value.note]])])]),e("div",at,[o(se,{onClick:t[10]||(t[10]=s=>w.value=!1),class:"flex-1 !h-12 !rounded-xl !text-[10px] !font-black !uppercase"},{default:v(()=>[...t[31]||(t[31]=[V("Cancel Registry",-1)])]),_:1}),o(R,{onClick:K,disabled:M.value||!c.value.category_id,class:"flex-1 !h-12 !rounded-xl !text-[10px] !font-black !uppercase"},{default:v(()=>[V(g(M.value?"Registering...":"Add to System"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64)}}};export{xt as default};
