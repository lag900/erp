import{u as e,o as s,a as t,k as a,m as i,p as r,w as l,b as o,q as n,e as d,d as m,s as u,F as c,z as g,t as p,x,N as f,l as b,c as h,g as y,A as v}from"./vendor-DGI0tb4d.js";import{_}from"./AuthenticatedLayout-odOuIOG-.js";import{P as w}from"./PrimaryButton-CXxvsKbC.js";import{_ as k}from"./TextInput-7Tb4wL4u.js";import{_ as j}from"./InputLabel-ttg1gjZN.js";import{_ as B}from"./InputError-CSjO0CYp.js";import{_ as C}from"./EntityImage-CGB1-HgO.js";import{i as A}from"./browser-image-compression-Dr3HYh3O.js";import"./utils-B98O4e5m.js";/* empty css                                                              */import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./DangerButton-Bzsvvehx.js";import"./SecondaryButton-DsdD6xme.js";const V={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},M={class:"flex items-center gap-3"},U={class:"py-8"},S={class:"mx-auto max-w-3xl sm:px-6 lg:px-8"},T={class:"border-b border-slate-100 bg-slate-50/50 px-8 py-6 flex items-center justify-between"},q={class:"p-6 grid gap-6 sm:grid-cols-2"},D={class:"sm:col-span-2"},E={class:"relative mt-1"},I=["value"],P={class:"sm:col-span-2 flex items-center gap-2"},L={class:"sm:col-span-2"},G={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 border rounded-lg p-4 bg-gray-50/50"},H=["id","value"],N=["for"],O={key:0,class:"ml-1 text-[10px] px-1.5 py-0.5 bg-blue-50 text-blue-600 rounded-full font-bold uppercase tracking-wider border border-blue-100"},F={class:"mt-2 inline-flex items-center rounded-lg bg-gray-100 px-4 py-2 text-sm font-mono font-bold text-gray-700 border border-gray-200"},R={class:"sm:col-span-2"},W={class:"mt-2 flex gap-6"},z={class:"shrink-0 relative"},$={class:"grow rounded-lg border border-dashed border-gray-900/25 px-6 py-10"},J={class:"text-center"},Q={class:"mt-4 flex text-sm leading-6 text-gray-600 justify-center"},K={for:"image",class:"relative cursor-pointer rounded-md bg-white font-semibold text-primary focus-within:outline-none focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-2 hover:text-indigo-500"},X={key:0,class:"mt-2 text-sm font-semibold text-green-600"},Y={class:"bg-gray-50 px-6 py-4 flex items-center justify-end gap-3 border-t border-gray-100"},Z={__name:"Edit",props:{building:{type:Object,required:!0},locations:{type:Array,required:!0},departments:{type:Array,required:!0}},setup(Z){const ee=Z,se=v(),te=y(()=>se.props.auth?.permissions??[]),ae=e=>te.value.includes(e),ie=e({_method:"PUT",location_id:ee.building.location_id,name_en:ee.building.name_en,name_ar:ee.building.name_ar,is_shared:ee.building.is_shared,department_ids:ee.building.department_ids||[],image:null}),re=async e=>{const s=e.target.files[0];if(!s)return;const t={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8};try{const e=await A(s,t);ie.image=e}catch(a){ie.image=s}};return(e,y)=>(s(),t(c,null,[a(i(r),{title:"Edit Building"}),a(_,null,{header:l(()=>[o("div",V,[y[8]||(y[8]=o("div",null,[o("h2",{class:"text-2xl font-bold leading-tight text-gray-800"}," Edit Building "),o("p",{class:"mt-1 text-sm text-gray-500"}," Update building information and visual assets. ")],-1)),o("div",M,[a(i(b),{href:e.route("buildings.index"),class:"inline-flex items-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},{default:l(()=>[...y[7]||(y[7]=[o("svg",{class:"mr-2 -ml-1 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),d(" Back to Buildings ",-1)])]),_:1},8,["href"])])])]),default:l(()=>[o("div",U,[o("div",S,[o("form",{class:"overflow-hidden rounded-[32px] border border-slate-200 bg-white shadow-premium",onSubmit:y[6]||(y[6]=n(s=>i(ie).post(e.route("buildings.update",Z.building.id),{forceFormData:!0,onSuccess:()=>e.window.showToast("success","Building updated successfully.")}),["prevent"]))},[o("div",T,[y[10]||(y[10]=o("div",null,[o("h3",{class:"text-xl font-bold text-slate-800 tracking-tight"},"Building Profile"),o("p",{class:"text-[13px] font-medium text-slate-400"},"Manage institutional facility details.")],-1)),ae("building-delete")?(s(),t("button",{key:0,type:"button",class:"inline-flex items-center rounded-xl bg-rose-50 px-4 py-2 text-xs font-bold text-rose-600 border border-rose-100 transition-all hover:bg-rose-100 hover:scale-105 active:scale-95",onClick:y[0]||(y[0]=s=>e.window.showConfirm({title:"Decommission Building?",message:`Are you sure you want to decommission ${Z.building.name_en}? This will remove it from all active mapping.`,confirmText:"Decommission",onConfirm:()=>e.$inertia.delete(e.route("buildings.destroy",Z.building.id))}))},[...y[9]||(y[9]=[o("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),d(" Decommission ",-1)])])):m("",!0)]),o("div",q,[o("div",D,[a(j,{for:"location_id",value:"Location"}),o("div",E,[u(o("select",{id:"location_id","onUpdate:modelValue":y[1]||(y[1]=e=>i(ie).location_id=e),class:"block w-full appearance-none rounded-lg border-gray-300 bg-white py-2 pl-3 pr-10 text-sm shadow-sm focus:border-primary focus:outline-none focus:ring-primary"},[y[11]||(y[11]=o("option",{value:"",disabled:""},"Select a location...",-1)),(s(!0),t(c,null,g(Z.locations,e=>(s(),t("option",{key:e.id,value:e.id},p(e.name),9,I))),128))],512),[[x,i(ie).location_id]]),y[12]||(y[12]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),a(B,{class:"mt-2",message:i(ie).errors.location_id},null,8,["message"])]),o("div",null,[a(j,{for:"name_en",value:"English Name (Required)"}),a(k,{id:"name_en",modelValue:i(ie).name_en,"onUpdate:modelValue":y[2]||(y[2]=e=>i(ie).name_en=e),class:"mt-1 block w-full",required:""},null,8,["modelValue"]),a(B,{class:"mt-2",message:i(ie).errors.name_en},null,8,["message"])]),o("div",null,[a(j,{for:"name_ar",value:"Arabic Name (Optional)"}),a(k,{id:"name_ar",modelValue:i(ie).name_ar,"onUpdate:modelValue":y[3]||(y[3]=e=>i(ie).name_ar=e),class:"mt-1 block w-full text-right",dir:"rtl"},null,8,["modelValue"]),a(B,{class:"mt-2",message:i(ie).errors.name_ar},null,8,["message"])]),o("div",P,[u(o("input",{type:"checkbox",id:"is_shared","onUpdate:modelValue":y[4]||(y[4]=e=>i(ie).is_shared=e),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[f,i(ie).is_shared]]),a(j,{for:"is_shared",value:"This is a shared building (available across all departments)"})]),o("div",L,[a(j,{value:"Assigned Departments"}),y[13]||(y[13]=o("p",{class:"text-xs text-gray-500 mb-3"},"Select one or more departments that have access to this building.",-1)),o("div",G,[(s(!0),t(c,null,g(Z.departments,e=>(s(),t("div",{key:e.id,class:"flex items-center gap-3"},[u(o("input",{type:"checkbox",id:"dept-"+e.id,value:e.id,"onUpdate:modelValue":y[5]||(y[5]=e=>i(ie).department_ids=e),class:"rounded border-gray-300 text-primary shadow-sm focus:ring-primary h-4 w-4"},null,8,H),[[f,i(ie).department_ids]]),o("label",{for:"dept-"+e.id,class:"text-sm font-medium text-slate-700 cursor-pointer select-none"},[d(p(e.name)+" ",1),"Administration"===e.name?(s(),t("span",O,"Root")):m("",!0)],8,N)]))),128))]),a(B,{class:"mt-2",message:i(ie).errors.department_ids},null,8,["message"])]),o("div",null,[a(j,{value:"Building Code (Auto-Generated)"}),o("div",F,p(Z.building.code||"AUTO"),1),y[14]||(y[14]=o("p",{class:"mt-1 text-xs text-gray-500"},"Automatically generated from building name.",-1))]),o("div",R,[a(j,{for:"image",value:"Building Image"}),o("div",W,[o("div",z,[a(C,{src:Z.building.image_url,alt:Z.building.name,type:"building",class:"h-24 w-24 rounded-lg border border-gray-200"},null,8,["src","alt"]),y[15]||(y[15]=o("p",{class:"mt-1 text-center text-xs text-gray-500"},"Current",-1))]),o("div",$,[o("div",J,[y[17]||(y[17]=o("svg",{class:"mx-auto h-12 w-12 text-gray-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),o("div",Q,[o("label",K,[o("span",null,p(Z.building.image_url?"Replace image":"Upload a file"),1),o("input",{id:"image",type:"file",accept:"image/*",capture:"environment",class:"sr-only",onChange:re},null,32)]),y[16]||(y[16]=o("p",{class:"pl-1"},"or drag and drop",-1))]),y[18]||(y[18]=o("p",{class:"text-xs leading-5 text-gray-600"},"PNG, JPG, GIF up to 2MB",-1)),i(ie).image?(s(),t("p",X," Selected: "+p(i(ie).image.name),1)):m("",!0)])])]),a(B,{class:"mt-2",message:i(ie).errors.image},null,8,["message"])])]),o("div",Y,[a(i(b),{href:e.route("buildings.index"),class:"text-sm font-medium text-gray-600 hover:text-gray-900"},{default:l(()=>[...y[19]||(y[19]=[d(" Cancel ",-1)])]),_:1},8,["href"]),ae("building-edit")?(s(),h(w,{key:0,disabled:i(ie).processing},{default:l(()=>[...y[20]||(y[20]=[o("svg",{class:"mr-2 -ml-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),d(" Save Changes ",-1)])]),_:1},8,["disabled"])):m("",!0)])],32)])])]),_:1})],64))}};export{Z as default};
