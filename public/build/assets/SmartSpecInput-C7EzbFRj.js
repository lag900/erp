import{C as e,D as a,G as t,E as l,o as r,a as o,b as s,d as n,k as u,w as c,F as i,z as d,t as p,q as v,T as g,s as m,v as f,H as y,y as b,g as x,I as w}from"./vendor-DGI0tb4d.js";import{a as h}from"./utils-B98O4e5m.js";const k={class:"relative"},C=["value","placeholder"],A={class:"absolute right-3 top-2.5"},V={key:0,class:"animate-spin h-3 w-3 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},I={key:0,class:"absolute z-[100] mt-1 max-h-48 w-full overflow-auto rounded border border-gray-200 bg-white py-0 text-sm shadow-lg focus:outline-none"},F=["onClick"],L={class:"text-xs uppercase tracking-wider"},_=["onClick"],j={key:0,class:"fixed inset-0 z-[110] flex items-center justify-center bg-gray-900/40 backdrop-blur-[2px] p-4 text-left"},z={class:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-6 leading-relaxed"},S={class:"space-y-1 mb-8"},E={class:"flex gap-4"},R=["disabled"],T={__name:"SmartSpecInput",props:{modelValue:String,categoryId:[Number,String],placeholder:{type:String,default:"Select or type specification..."}},emits:["update:modelValue"],setup(T,{emit:G}){const H=T,B=G,M=b([]),N=b(!1),q=b(!1),D=b(null),K=b(null),O=b(null),U=b(""),J=async()=>{if(U.value&&U.value!==O.value)try{await h.post(route("api.categories.rename-spec-template",H.categoryId),{old_key:O.value,new_key:U.value});const e=M.value.indexOf(O.value);-1!==e&&(M.value[e]=U.value),H.modelValue===O.value&&B("update:modelValue",U.value),O.value=null}catch(e){alert("Failed to rename template: "+(e.response?.data?.message||e.message))}},P=x(()=>{if(!H.modelValue)return M.value;const e=H.modelValue.toLowerCase();return M.value.filter(a=>a.toLowerCase().includes(e))});e(()=>H.categoryId,()=>{(async()=>{if(H.categoryId){q.value=!0;try{const e=await h.get(route("api.categories.spec-templates",H.categoryId));M.value=e.data}catch(e){}finally{q.value=!1}}else M.value=[]})()},{immediate:!0});const Q=e=>{B("update:modelValue",e.target.value),N.value=!0},W=e=>{D.value&&!D.value.contains(e.target)&&(N.value=!1)};return a(()=>{document.addEventListener("click",W)}),t(()=>{document.removeEventListener("click",W)}),(e,a)=>{const t=l("InputLabel");return r(),o("div",{class:"relative w-full",ref_key:"containerRef",ref:D},[s("div",k,[s("input",{type:"text",value:T.modelValue,onInput:Q,onFocus:a[0]||(a[0]=e=>N.value=!0),class:"block w-full rounded border-gray-300 bg-white px-3 py-2 text-sm transition-all focus:border-[#1FA6A0] focus:ring-0 focus:bg-white",placeholder:T.placeholder},null,40,C),s("div",A,[q.value?(r(),o("svg",V,[...a[4]||(a[4]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):n("",!0)])]),u(g,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:c(()=>[N.value&&P.value.length>0?(r(),o("ul",I,[(r(!0),o(i,null,d(P.value,e=>(r(),o("li",{key:e,class:"group relative flex items-center justify-between cursor-pointer select-none px-4 py-2.5 hover:bg-gray-50 hover:text-[#1FA6A0] font-bold transition-colors border-b border-gray-50 last:border-none",onClick:a=>(e=>{B("update:modelValue",e),N.value=!1})(e)},[s("span",L,p(e),1),s("button",{onClick:v(a=>{return t=e,O.value=t,U.value=t,N.value=!1,void w(()=>{K.value?.focus()});var t},["stop"]),class:"hidden group-hover:flex items-center justify-center p-1 rounded border border-gray-200 text-gray-400 hover:bg-white hover:text-[#1FA6A0] transition-all",title:"Rename Global Template"},[...a[5]||(a[5]=[s("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])],8,_)],8,F))),128))])):n("",!0)]),_:1}),O.value?(r(),o("div",j,[s("div",{class:"w-full max-w-sm rounded bg-white p-8 shadow-2xl border border-gray-200",onClick:a[3]||(a[3]=v(()=>{},["stop"]))},[a[6]||(a[6]=s("h4",{class:"text-xs font-black uppercase tracking-[0.2em] text-gray-900 mb-2"},"Global Template Refactor",-1)),s("p",z,'Renaming "'+p(O.value)+'" will affect the master registry for this category.',1),s("div",S,[u(t,{value:"New Template Label",class:"text-[10px] font-black uppercase text-gray-500"}),m(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),type:"text",class:"block w-full rounded border-gray-300 px-3 py-2 text-sm font-bold shadow-none focus:border-[#1FA6A0] focus:ring-0",placeholder:"Enter new label name...",onKeyup:y(J,["enter"]),ref_key:"renameInput",ref:K},null,544),[[f,U.value]])]),s("div",E,[s("button",{onClick:a[2]||(a[2]=e=>O.value=null),class:"flex-1 rounded border border-gray-200 bg-white py-3 text-[10px] font-black uppercase tracking-widest text-gray-400 hover:bg-gray-50 transition-colors"}," Abort "),s("button",{onClick:J,disabled:!U.value||U.value===O.value,class:"flex-1 rounded bg-[#1FA6A0] py-3 text-[10px] font-black uppercase tracking-widest text-white hover:bg-[#168C87] disabled:opacity-50 transition-colors shadow-lg shadow-[#1FA6A0]/20"}," Confirm Change ",8,R)])])])):n("",!0)],512)}}};export{T as _};
