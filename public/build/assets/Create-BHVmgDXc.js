import{u as E,o as a,c as d,a as l,b as n,h as F,w as m,d as s,e as I,t as c,F as v,m as b,k as P,i as _,j as R,_ as S,p,r as D,q as T}from"./app-CehYguHu.js";import{_ as q}from"./AuthenticatedLayout-CfY1nA_Q.js";import{_ as B}from"./TextInput-CVQfVas4.js";import{_ as H}from"./InputLabel-BdAlJ2D5.js";import{_ as U}from"./InputError-51rjNbxD.js";import{G as f}from"./GlobalCheckbox-CqgO5sP7.js";/* empty css                                                              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DangerButton-DmNu9a4c.js";import"./SecondaryButton-C9gXAhlZ.js";const K={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},J={class:"py-10"},O={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Q={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white p-8 shadow-premium"},W={class:"max-w-md"},X={class:"space-y-6"},Y={class:"flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between px-2"},Z={class:"flex items-center gap-6 bg-white px-6 py-3 rounded-2xl border border-gray-100 shadow-soft"},ee={class:"flex items-center gap-3"},se={class:"text-[10px] font-bold text-gray-400 uppercase tracking-tighter"},te={class:"relative w-full sm:w-80"},re={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 text-start"},oe={class:"flex items-center justify-between border-b border-gray-100 bg-gray-50/50 px-6 py-4"},ie={class:"flex items-center gap-3"},le={class:"text-xs font-black uppercase tracking-widest text-gray-900"},ne={class:"text-[9px] font-bold uppercase text-gray-400"},ae={class:"flex-1 space-y-1 p-4"},de=["for"],ce={class:"block text-sm font-bold text-gray-700 group-hover:text-primary transition-colors"},ue={class:"block text-[8px] font-black uppercase text-gray-300 tracking-widest leading-none"},me={key:0,class:"mt-12 bg-gray-50/50 rounded-3xl p-8 border border-dashed border-gray-200 text-start"},pe={class:"flex items-center gap-3 mb-6 px-2"},ge={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},fe=["for"],he={class:"text-xs font-bold text-gray-600 tracking-tight"},xe={class:"sticky bottom-8 flex items-center justify-between rounded-2xl border border-gray-200 bg-white shadow-2xl p-6 ring-1 ring-black/5"},ve={class:"flex items-center gap-4 text-sm font-bold text-gray-500"},ye={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gray-100 text-gray-900 border border-gray-200"},be={class:"flex gap-3"},Le={__name:"Create",props:{groups:Array,ungrouped:Array},setup(V){const h=V,L=()=>{r.post(route("roles.store"),{onSuccess:()=>{window.showToast&&window.showToast("success","Security Persona established successfully.")}})},x=D(""),G=T(),M=p(()=>G.props.auth?.permissions??[]),$=t=>M.value.includes(t),r=E({name:"",permission_ids:[]}),z=p(()=>{const t=x.value.trim().toLowerCase();return h.groups.map(e=>{const o=e.permissions.filter(i=>i.name.toLowerCase().includes(t)||i.description&&i.description.toLowerCase().includes(t));return{...e,matchedPerms:o}}).filter(e=>e.matchedPerms.length>0)}),g=p(()=>{const t=x.value.trim().toLowerCase();return h.ungrouped.filter(e=>e.name.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t))}),w=t=>{const e=t.map(i=>i.id);if(e.every(i=>r.permission_ids.includes(i)))r.permission_ids=r.permission_ids.filter(i=>!e.includes(i));else{const i=e.filter(y=>!r.permission_ids.includes(y));r.permission_ids=[...r.permission_ids,...i]}},k=t=>t.length>0&&t.every(e=>r.permission_ids.includes(e.id)),C=t=>{const e=t.filter(o=>r.permission_ids.includes(o.id)).length;return e>0&&e<t.length},u=p(()=>{const t=[];return h.groups.forEach(e=>t.push(...e.permissions)),t.push(...h.ungrouped),t}),j=p(()=>u.value.length>0&&u.value.every(t=>r.permission_ids.includes(t.id))),A=p(()=>{const t=u.value.filter(e=>r.permission_ids.includes(e.id)).length;return t>0&&t<u.value.length}),N=()=>{j.value?r.permission_ids=[]:r.permission_ids=u.value.map(t=>t.id)};return(t,e)=>(a(),d(v,null,[l(n(F),{title:"Establish New Role Identity"}),l(q,null,{header:m(()=>[s("div",K,[e[7]||(e[7]=s("div",null,[s("h2",{class:"text-2xl font-bold leading-tight text-gray-800"}," New Security Persona "),s("p",{class:"mt-1 text-sm text-gray-500"},"Define a new functional identity and its operational boundaries.")],-1)),l(S,{href:t.route("roles.index"),variant:"secondary"},{icon:m(()=>[...e[5]||(e[5]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),default:m(()=>[e[6]||(e[6]=_(" Back to Registry ",-1))]),_:1},8,["href"])])]),default:m(()=>[s("div",J,[s("div",O,[s("form",{class:"space-y-8",onSubmit:I(L,["prevent"])},[s("div",Q,[e[8]||(e[8]=s("div",{class:"flex items-center gap-4 mb-6"},[s("div",{class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary"},[s("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])]),s("div",null,[s("h3",{class:"text-lg font-bold text-gray-900 uppercase tracking-tighter"},"Persona Core"),s("p",{class:"text-xs text-gray-400"},"Provide a unique designation for this operational role.")])],-1)),s("div",W,[l(H,{for:"name",value:"Role Designation",class:"text-xs font-black uppercase tracking-widest text-gray-500 mb-2"}),l(B,{id:"name",modelValue:n(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>n(r).name=o),class:"block w-full border-gray-200 focus:border-primary focus:ring-primary h-12 rounded-xl shadow-soft",placeholder:"e.g., Inventory Auditor",autofocus:""},null,8,["modelValue"]),l(U,{class:"mt-2",message:n(r).errors.name},null,8,["message"])])]),s("div",X,[s("div",Y,[s("div",Z,[s("div",ee,[l(f,{id:"global-select-all",checked:j.value,indeterminate:A.value,"onUpdate:checked":N},null,8,["checked","indeterminate"]),e[9]||(e[9]=s("label",{for:"global-select-all",class:"text-xs font-black uppercase tracking-widest text-gray-900 cursor-pointer select-none"}," Global Selector ",-1))]),e[10]||(e[10]=s("div",{class:"h-4 w-px bg-gray-200"},null,-1)),s("div",se,c(n(r).permission_ids.length)+" / "+c(u.value.length)+" Gates Enabled ",1)]),s("div",te,[e[11]||(e[11]=s("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[s("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),l(B,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=o=>x.value=o),class:"block w-full border-gray-200 pl-10 h-11 rounded-xl text-sm transition-all focus:ring-primary/20 shadow-soft",placeholder:"Search authorization keys..."},null,8,["modelValue"])])]),s("div",re,[(a(!0),d(v,null,b(z.value,o=>(a(),d("div",{key:o.id,class:"group relative flex flex-col overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-soft transition-all duration-300 hover:border-primary/20 hover:shadow-lg"},[s("div",oe,[s("div",ie,[l(f,{id:"group-"+o.id,checked:k(o.matchedPerms),indeterminate:C(o.matchedPerms),"onUpdate:checked":i=>w(o.matchedPerms)},null,8,["id","checked","indeterminate","onUpdate:checked"]),s("h4",le,c(o.name),1)]),s("span",ne,c(o.matchedPerms.length)+" Keys ",1)]),s("div",ae,[(a(!0),d(v,null,b(o.matchedPerms,i=>(a(),d("div",{key:i.id,class:"flex items-center justify-between rounded-xl px-3 py-2.5 transition-all hover:bg-gray-50 group/item"},[s("label",{for:"perm-"+i.id,class:"flex cursor-pointer items-center gap-4 flex-1"},[l(f,{id:"perm-"+i.id,checked:n(r).permission_ids,"onUpdate:checked":e[2]||(e[2]=y=>n(r).permission_ids=y),value:i.id},null,8,["id","checked","value"]),s("div",null,[s("span",ce,c(i.name.split("-").join(" ")),1),s("span",ue,c(i.name),1)])],8,de)]))),128))])]))),128))]),g.value.length>0?(a(),d("div",me,[s("div",pe,[l(f,{id:"group-ungrouped",checked:k(g.value),indeterminate:C(g.value),"onUpdate:checked":e[3]||(e[3]=o=>w(g.value))},null,8,["checked","indeterminate"]),e[12]||(e[12]=s("h4",{class:"text-xs font-black uppercase tracking-[0.3em] text-gray-400"},"Legacy / Uncategorized Gates",-1))]),s("div",ge,[(a(!0),d(v,null,b(g.value,o=>(a(),d("div",{key:o.id,class:"flex items-center justify-between rounded-2xl bg-white border border-gray-100 p-4 transition-all hover:border-primary/30"},[s("label",{for:"perm-un-"+o.id,class:"flex cursor-pointer items-center justify-between w-full"},[s("span",he,c(o.name),1),l(f,{id:"perm-un-"+o.id,checked:n(r).permission_ids,"onUpdate:checked":e[4]||(e[4]=i=>n(r).permission_ids=i),value:o.id},null,8,["id","checked","value"])],8,fe)]))),128))])])):P("",!0),l(U,{class:"mt-2",message:n(r).errors.permission_ids},null,8,["message"])]),s("div",xe,[s("div",ve,[s("span",ye,c(n(r).permission_ids.length),1),e[13]||(e[13]=_(" Permissions Bound ",-1))]),s("div",be,[$("role-create")?(a(),R(S,{key:0,type:"submit",variant:"primary",processing:n(r).processing,class:"min-w-[160px]"},{icon:m(()=>[...e[14]||(e[14]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])]),default:m(()=>[e[15]||(e[15]=_(" Finalize Role ",-1))]),_:1},8,["processing"])):P("",!0)])])],32)])])]),_:1})],64))}};export{Le as default};
