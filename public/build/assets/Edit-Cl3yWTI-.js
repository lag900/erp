import{u as e,o as s,a as r,k as t,m as i,p as l,w as a,b as o,q as n,t as d,F as c,z as p,d as u,n as m,e as g,c as h,g as x,y as f,A as y}from"./vendor-DGI0tb4d.js";import{_ as v}from"./AuthenticatedLayout-Cfq4davl.js";import{_ as b}from"./app-Ovv-U1T0.js";import{_ as k}from"./TextInput-7Tb4wL4u.js";import{_ as w}from"./InputLabel-ttg1gjZN.js";import{_}from"./InputError-CSjO0CYp.js";import{G as j}from"./GlobalCheckbox-BSagvGQB.js";import"./utils-B98O4e5m.js";/* empty css                                                              */import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./DangerButton-Bzsvvehx.js";import"./SecondaryButton-DsdD6xme.js";const C={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},M={class:"mt-1 text-sm text-gray-500"},L={class:"font-black text-primary"},P={class:"flex flex-wrap gap-2"},A={class:"py-10"},B={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},U={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white p-8 shadow-premium"},z={class:"max-w-md"},S={class:"space-y-6"},V={class:"flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between px-2"},E={class:"flex items-center gap-6 bg-white px-6 py-3 rounded-2xl border border-gray-100 shadow-soft"},G={class:"flex items-center gap-3"},R={class:"text-[10px] font-bold text-gray-400 uppercase tracking-tighter"},T={class:"relative w-full sm:w-80"},D={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},I={class:"flex items-center justify-between border-b border-gray-100 bg-gray-50/50 px-6 py-4"},H={class:"flex items-center gap-3"},F={class:"text-xs font-black uppercase tracking-widest text-gray-900"},$={class:"text-[9px] font-bold uppercase text-gray-400"},q={class:"flex-1 space-y-1 p-4"},K=["for"],N={class:"block text-sm font-bold text-gray-700 group-hover:text-primary transition-colors"},O={class:"block text-[8px] font-black uppercase text-gray-300 tracking-widest leading-none"},W={key:0,class:"text-[10px] font-black uppercase text-primary/40 tracking-tighter"},J={class:"px-6 py-3 border-t border-gray-50 flex items-center justify-between text-[10px] font-bold text-gray-400"},Q={class:"flex gap-0.5"},X={key:0,class:"mt-12 bg-gray-50/50 rounded-3xl p-8 border border-dashed border-gray-200"},Y={class:"flex items-center gap-3 mb-6 px-2"},Z={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},ee=["for"],se={class:"text-xs font-bold text-gray-600 tracking-tight"},re={class:"sticky bottom-8 flex items-center justify-between rounded-2xl border border-gray-200 bg-white shadow-2xl p-6 ring-1 ring-black/5"},te={class:"flex items-center gap-4 text-sm font-bold text-gray-500"},ie={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gray-100 text-gray-900 border border-gray-200"},le={class:"flex gap-3"},ae={__name:"Edit",props:{role:Object,groups:Array,ungrouped:Array},setup(ae){const oe=ae,ne=()=>{me.put(route("roles.update",oe.role.id),{onSuccess:()=>{window.showToast&&window.showToast("success","Security matrix updated successfully.")}})},de=f(""),ce=y(),pe=x(()=>ce.props.auth?.permissions??[]),ue=e=>pe.value.includes(e),me=e({name:oe.role.name,permission_ids:oe.role.permission_ids||[]}),ge=x(()=>{const e=de.value.trim().toLowerCase();return oe.groups.map(s=>{const r=s.permissions.filter(s=>s.name.toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e));return{...s,matchedPerms:r}}).filter(e=>e.matchedPerms.length>0)}),he=x(()=>{const e=de.value.trim().toLowerCase();return oe.ungrouped.filter(s=>s.name.toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e))}),xe=e=>{const s=e.map(e=>e.id);if(s.every(e=>me.permission_ids.includes(e)))me.permission_ids=me.permission_ids.filter(e=>!s.includes(e));else{const e=s.filter(e=>!me.permission_ids.includes(e));me.permission_ids=[...me.permission_ids,...e]}},fe=e=>e.length>0&&e.every(e=>me.permission_ids.includes(e.id)),ye=e=>{const s=e.filter(e=>me.permission_ids.includes(e.id)).length;return s>0&&s<e.length},ve=x(()=>{const e=[];return oe.groups.forEach(s=>e.push(...s.permissions)),e.push(...oe.ungrouped),e}),be=x(()=>ve.value.length>0&&ve.value.every(e=>me.permission_ids.includes(e.id))),ke=x(()=>{const e=ve.value.filter(e=>me.permission_ids.includes(e.id)).length;return e>0&&e<ve.value.length}),we=()=>{be.value?me.permission_ids=[]:me.permission_ids=ve.value.map(e=>e.id)};return(e,x)=>(s(),r(c,null,[t(i(l),{title:`Secure Matrix: ${i(me).name}`},null,8,["title"]),t(v,null,{header:a(()=>[o("div",C,[o("div",null,[x[9]||(x[9]=o("h2",{class:"text-2xl font-bold leading-tight text-gray-800"}," Access Control Matrix ",-1)),o("p",M,[x[7]||(x[7]=g("Fine-tune the operational perimeter for ",-1)),o("span",L,d(ae.role.name),1),x[8]||(x[8]=g(".",-1))])]),o("div",P,[t(b,{href:e.route("roles.index"),variant:"secondary"},{icon:a(()=>[...x[10]||(x[10]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),default:a(()=>[x[11]||(x[11]=g(" Return to Registry ",-1))]),_:1},8,["href"]),ue("role-delete")&&"SuperAdmin"!==ae.role.name?(s(),h(b,{key:0,variant:"danger",onClick:x[0]||(x[0]=()=>{e.window.confirm("Wipe this role and its access keys?")&&e.$inertia.delete(e.route("roles.destroy",ae.role.id))}),title:"Delete Role"},{icon:a(()=>[...x[12]||(x[12]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])]),_:1})):u("",!0)])])]),default:a(()=>[o("div",A,[o("div",B,[o("form",{class:"space-y-8",onSubmit:n(ne,["prevent"])},[o("div",U,[x[13]||(x[13]=o("div",{class:"flex items-center gap-4 mb-6"},[o("div",{class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary"},[o("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])]),o("div",null,[o("h3",{class:"text-lg font-bold text-gray-900 uppercase tracking-tighter"},"Identity Core"),o("p",{class:"text-xs text-gray-400"},"The primary label used for identifying this role across the system.")])],-1)),o("div",z,[t(w,{for:"name",value:"Role Designation",class:"text-xs font-black uppercase tracking-widest text-gray-500 mb-2"}),t(k,{id:"name",modelValue:i(me).name,"onUpdate:modelValue":x[1]||(x[1]=e=>i(me).name=e),class:"block w-full border-gray-200 focus:border-primary focus:ring-primary h-12 rounded-xl shadow-soft",placeholder:"e.g., Regional Manager"},null,8,["modelValue"]),t(_,{class:"mt-2",message:i(me).errors.name},null,8,["message"])])]),o("div",S,[o("div",V,[o("div",E,[o("div",G,[t(j,{id:"global-select-all",checked:be.value,indeterminate:ke.value,"onUpdate:checked":we},null,8,["checked","indeterminate"]),x[14]||(x[14]=o("label",{for:"global-select-all",class:"text-xs font-black uppercase tracking-widest text-gray-900 cursor-pointer select-none"}," Global Selector ",-1))]),x[15]||(x[15]=o("div",{class:"h-4 w-px bg-gray-200"},null,-1)),o("div",R,d(i(me).permission_ids.length)+" / "+d(ve.value.length)+" Gates Enabled ",1)]),o("div",T,[x[16]||(x[16]=o("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[o("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),t(k,{modelValue:de.value,"onUpdate:modelValue":x[2]||(x[2]=e=>de.value=e),class:"block w-full border-gray-200 pl-10 h-11 rounded-xl text-sm transition-all focus:ring-primary/20 shadow-soft",placeholder:"Search authorization keys..."},null,8,["modelValue"])])]),o("div",D,[(s(!0),r(c,null,p(ge.value,e=>(s(),r("div",{key:e.id,class:"group relative flex flex-col overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-soft transition-all duration-300 hover:border-primary/20 hover:shadow-lg"},[o("div",I,[o("div",H,[t(j,{id:"group-"+e.id,checked:fe(e.matchedPerms),indeterminate:ye(e.matchedPerms),"onUpdate:checked":s=>xe(e.matchedPerms)},null,8,["id","checked","indeterminate","onUpdate:checked"]),o("h4",F,d(e.name),1)]),o("span",$,d(e.matchedPerms.length)+" Keys ",1)]),o("div",q,[(s(!0),r(c,null,p(e.matchedPerms,e=>(s(),r("div",{key:e.id,class:"flex items-center justify-between rounded-xl px-3 py-2.5 transition-all hover:bg-gray-50 group/item"},[o("label",{for:"perm-"+e.id,class:"flex cursor-pointer items-center gap-4 flex-1"},[t(j,{id:"perm-"+e.id,checked:i(me).permission_ids,"onUpdate:checked":x[3]||(x[3]=e=>i(me).permission_ids=e),value:e.id},null,8,["id","checked","value"]),o("div",null,[o("span",N,d(e.name.split("-").join(" ")),1),o("span",O,d(e.name),1)])],8,K),i(me).permission_ids.includes(e.id)?(s(),r("span",W,"Authorized")):u("",!0)]))),128))]),o("div",J,[o("span",null,d(e.matchedPerms.filter(e=>i(me).permission_ids.includes(e.id)).length)+" / "+d(e.matchedPerms.length)+" ENABLED",1),o("div",Q,[(s(!0),r(c,null,p(e.matchedPerms.length,t=>(s(),r("div",{key:t,class:m(["h-1 w-2 rounded-full",t<=e.matchedPerms.filter(e=>i(me).permission_ids.includes(e.id)).length?"bg-primary":"bg-gray-100"])},null,2))),128))])])]))),128))]),he.value.length>0?(s(),r("div",X,[o("div",Y,[t(j,{id:"group-ungrouped",checked:fe(he.value),indeterminate:ye(he.value),"onUpdate:checked":x[4]||(x[4]=e=>xe(he.value))},null,8,["checked","indeterminate"]),x[17]||(x[17]=o("h4",{class:"text-xs font-black uppercase tracking-[0.3em] text-gray-400"},"Legacy / Uncategorized Gates",-1))]),o("div",Z,[(s(!0),r(c,null,p(he.value,e=>(s(),r("div",{key:e.id,class:"flex items-center justify-between rounded-2xl bg-white border border-gray-100 p-4 transition-all hover:border-primary/30"},[o("label",{for:"perm-un-"+e.id,class:"flex cursor-pointer items-center justify-between w-full"},[o("span",se,d(e.name),1),t(j,{id:"perm-un-"+e.id,checked:i(me).permission_ids,"onUpdate:checked":x[5]||(x[5]=e=>i(me).permission_ids=e),value:e.id},null,8,["id","checked","value"])],8,ee)]))),128))])])):u("",!0),t(_,{class:"mt-2",message:i(me).errors.permission_ids},null,8,["message"])]),o("div",re,[o("div",te,[o("span",ie,d(i(me).permission_ids.length),1),x[18]||(x[18]=g(" Permissions Bound ",-1))]),o("div",le,[t(b,{type:"button",variant:"secondary",onClick:x[6]||(x[6]=e=>i(me).permission_ids=[])},{default:a(()=>[...x[19]||(x[19]=[g(" Clear All ",-1)])]),_:1}),ue("role-edit")?(s(),h(b,{key:0,type:"submit",variant:"primary",processing:i(me).processing,class:"min-w-[160px]"},{icon:a(()=>[...x[20]||(x[20]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])]),default:a(()=>[x[21]||(x[21]=g(" Apply Changes ",-1))]),_:1},8,["processing"])):u("",!0)])])],32)])])]),_:1})],64))}};export{ae as default};
