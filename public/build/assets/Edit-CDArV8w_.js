import{u as V,o as a,c as m,a as o,b as s,h as M,w as u,d as e,e as j,i as c,k as b,f as h,F as y,m as U,t as p,g as $,K as S,l as w,j as A,p as N,q as P}from"./app-CehYguHu.js";import{_ as T}from"./AuthenticatedLayout-CfY1nA_Q.js";import{P as D}from"./PrimaryButton-BWR49dfZ.js";import{_ as k}from"./TextInput-CVQfVas4.js";import{_ as d}from"./InputLabel-BdAlJ2D5.js";import{_ as f}from"./InputError-51rjNbxD.js";import{_ as F}from"./EntityImage-C3KjEjUh.js";import{i as q}from"./browser-image-compression-DILJcqf6.js";/* empty css                                                              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DangerButton-DmNu9a4c.js";import"./SecondaryButton-C9gXAhlZ.js";const E={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},G={class:"flex items-center gap-3"},H={class:"py-8"},I={class:"mx-auto max-w-3xl sm:px-6 lg:px-8"},L={class:"border-b border-slate-100 bg-slate-50/50 px-8 py-6 flex items-center justify-between"},O={class:"p-6 grid gap-6 sm:grid-cols-2"},W={class:"sm:col-span-2"},R={class:"relative mt-1"},z=["value"],J={class:"sm:col-span-2 flex items-center gap-2"},K={class:"mt-2 inline-flex items-center rounded-lg bg-gray-100 px-4 py-2 text-sm font-mono font-bold text-gray-700 border border-gray-200"},Q={class:"sm:col-span-2"},X={class:"mt-2 flex gap-6"},Y={class:"shrink-0 relative"},Z={class:"grow rounded-lg border border-dashed border-gray-900/25 px-6 py-10"},ee={class:"text-center"},te={class:"mt-4 flex text-sm leading-6 text-gray-600 justify-center"},se={for:"image",class:"relative cursor-pointer rounded-md bg-white font-semibold text-primary focus-within:outline-none focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-2 hover:text-indigo-500"},ie={key:0,class:"mt-2 text-sm font-semibold text-green-600"},oe={class:"bg-gray-50 px-6 py-4 flex items-center justify-end gap-3 border-t border-gray-100"},be={__name:"Edit",props:{building:{type:Object,required:!0},locations:{type:Array,required:!0}},setup(l){const g=l,_=P(),B=N(()=>_.props.auth?.permissions??[]),v=n=>B.value.includes(n),i=V({_method:"PUT",location_id:g.building.location_id,name_en:g.building.name_en,name_ar:g.building.name_ar,is_shared:g.building.is_shared,image:null}),C=async n=>{const t=n.target.files[0];if(!t)return;const r={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8};try{const x=await q(t,r);i.image=x}catch(x){console.error("Image compression failed:",x),i.image=t}};return(n,t)=>(a(),m(y,null,[o(s(M),{title:"Edit Building"}),o(T,null,{header:u(()=>[e("div",E,[t[7]||(t[7]=e("div",null,[e("h2",{class:"text-2xl font-bold leading-tight text-gray-800"}," Edit Building "),e("p",{class:"mt-1 text-sm text-gray-500"}," Update building information and visual assets. ")],-1)),e("div",G,[o(s(w),{href:n.route("buildings.index"),class:"inline-flex items-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},{default:u(()=>[...t[6]||(t[6]=[e("svg",{class:"mr-2 -ml-1 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),c(" Back to Buildings ",-1)])]),_:1},8,["href"])])])]),default:u(()=>[e("div",H,[e("div",I,[e("form",{class:"overflow-hidden rounded-[32px] border border-slate-200 bg-white shadow-premium",onSubmit:t[5]||(t[5]=j(r=>s(i).post(n.route("buildings.update",l.building.id),{forceFormData:!0,onSuccess:()=>n.window.showToast("success","Building updated successfully.")}),["prevent"]))},[e("div",L,[t[9]||(t[9]=e("div",null,[e("h3",{class:"text-xl font-bold text-slate-800 tracking-tight"},"Building Profile"),e("p",{class:"text-[13px] font-medium text-slate-400"},"Manage institutional facility details.")],-1)),v("building-delete")?(a(),m("button",{key:0,type:"button",class:"inline-flex items-center rounded-xl bg-rose-50 px-4 py-2 text-xs font-bold text-rose-600 border border-rose-100 transition-all hover:bg-rose-100 hover:scale-105 active:scale-95",onClick:t[0]||(t[0]=r=>n.window.showConfirm({title:"Decommission Building?",message:`Are you sure you want to decommission ${l.building.name_en}? This will remove it from all active mapping.`,confirmText:"Decommission",onConfirm:()=>n.$inertia.delete(n.route("buildings.destroy",l.building.id))}))},[...t[8]||(t[8]=[e("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),c(" Decommission ",-1)])])):b("",!0)]),e("div",O,[e("div",W,[o(d,{for:"location_id",value:"Location"}),e("div",R,[h(e("select",{id:"location_id","onUpdate:modelValue":t[1]||(t[1]=r=>s(i).location_id=r),class:"block w-full appearance-none rounded-lg border-gray-300 bg-white py-2 pl-3 pr-10 text-sm shadow-sm focus:border-primary focus:outline-none focus:ring-primary"},[t[10]||(t[10]=e("option",{value:"",disabled:""},"Select a location...",-1)),(a(!0),m(y,null,U(l.locations,r=>(a(),m("option",{key:r.id,value:r.id},p(r.name),9,z))),128))],512),[[$,s(i).location_id]]),t[11]||(t[11]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),o(f,{class:"mt-2",message:s(i).errors.location_id},null,8,["message"])]),e("div",null,[o(d,{for:"name_en",value:"English Name (Required)"}),o(k,{id:"name_en",modelValue:s(i).name_en,"onUpdate:modelValue":t[2]||(t[2]=r=>s(i).name_en=r),class:"mt-1 block w-full",required:""},null,8,["modelValue"]),o(f,{class:"mt-2",message:s(i).errors.name_en},null,8,["message"])]),e("div",null,[o(d,{for:"name_ar",value:"Arabic Name (Optional)"}),o(k,{id:"name_ar",modelValue:s(i).name_ar,"onUpdate:modelValue":t[3]||(t[3]=r=>s(i).name_ar=r),class:"mt-1 block w-full text-right",dir:"rtl"},null,8,["modelValue"]),o(f,{class:"mt-2",message:s(i).errors.name_ar},null,8,["message"])]),e("div",J,[h(e("input",{type:"checkbox",id:"is_shared","onUpdate:modelValue":t[4]||(t[4]=r=>s(i).is_shared=r),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[S,s(i).is_shared]]),o(d,{for:"is_shared",value:"This is a shared building (available across all departments)"})]),e("div",null,[o(d,{value:"Building Code (Auto-Generated)"}),e("div",K,p(l.building.code||"AUTO"),1),t[12]||(t[12]=e("p",{class:"mt-1 text-xs text-gray-500"},"Automatically generated from building name.",-1))]),e("div",Q,[o(d,{for:"image",value:"Building Image"}),e("div",X,[e("div",Y,[o(F,{src:l.building.image_url,alt:l.building.name,type:"building",class:"h-24 w-24 rounded-lg border border-gray-200"},null,8,["src","alt"]),t[13]||(t[13]=e("p",{class:"mt-1 text-center text-xs text-gray-500"},"Current",-1))]),e("div",Z,[e("div",ee,[t[15]||(t[15]=e("svg",{class:"mx-auto h-12 w-12 text-gray-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),e("div",te,[e("label",se,[e("span",null,p(l.building.image_url?"Replace image":"Upload a file"),1),e("input",{id:"image",type:"file",accept:"image/*",capture:"environment",class:"sr-only",onChange:C},null,32)]),t[14]||(t[14]=e("p",{class:"pl-1"},"or drag and drop",-1))]),t[16]||(t[16]=e("p",{class:"text-xs leading-5 text-gray-600"},"PNG, JPG, GIF up to 2MB",-1)),s(i).image?(a(),m("p",ie," Selected: "+p(s(i).image.name),1)):b("",!0)])])]),o(f,{class:"mt-2",message:s(i).errors.image},null,8,["message"])])]),e("div",oe,[o(s(w),{href:n.route("buildings.index"),class:"text-sm font-medium text-gray-600 hover:text-gray-900"},{default:u(()=>[...t[17]||(t[17]=[c(" Cancel ",-1)])]),_:1},8,["href"]),v("building-edit")?(a(),A(D,{key:0,disabled:s(i).processing},{default:u(()=>[...t[18]||(t[18]=[e("svg",{class:"mr-2 -ml-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),c(" Save Changes ",-1)])]),_:1},8,["disabled"])):b("",!0)])],32)])])]),_:1})],64))}};export{be as default};
