import{y as e,B as t,C as s,o as a,a as l,k as o,m as r,p as d,w as i,b as n,t as c,F as p,z as u,s as x,v as b,x as g,n as v,l as f,e as m}from"./vendor-DGI0tb4d.js";import{_ as h}from"./AuthenticatedLayout-DmLSy_bE.js";import{_ as w}from"./Pagination-cB6t8acL.js";import{d as y}from"./debounce-DWKRusXY.js";import"./utils-B98O4e5m.js";/* empty css                                                              */import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./DangerButton-Bzsvvehx.js";import"./SecondaryButton-DsdD6xme.js";import"./debounce-D19TCx3D.js";const k={class:"flex items-center justify-between"},_={class:"flex items-center gap-3"},j=["href"],A={class:"py-8 space-y-8"},C={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},U={class:"bg-white p-6 rounded-[24px] border border-slate-100 shadow-soft"},S={class:"text-3xl font-black text-slate-800"},M={class:"bg-white p-6 rounded-[24px] border border-slate-100 shadow-soft"},V={class:"text-3xl font-black text-amber-600"},T={class:"bg-white p-6 rounded-[24px] border border-slate-100 shadow-soft"},B={class:"text-3xl font-black text-rose-600"},L={class:"bg-white p-6 rounded-[24px] border border-slate-100 shadow-soft overflow-hidden"},D={class:"flex flex-wrap gap-2 mt-2"},F={class:"bg-white p-8 rounded-[32px] border border-slate-200/60 shadow-soft"},O={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},z={class:"space-y-2"},I={class:"space-y-2"},E=["value"],P={class:"space-y-2"},R=["value"],W={class:"space-y-2"},$={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mt-6"},H={class:"space-y-2"},K=["value"],q={class:"space-y-2"},G={class:"space-y-2"},J={class:"bg-white rounded-[32px] border border-slate-200/60 shadow-soft overflow-hidden"},N={class:"overflow-x-auto"},Q={class:"w-full text-left"},X={class:"divide-y divide-slate-50"},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-[13px] font-bold text-slate-800 tabular-nums"},ee={class:"text-[10px] text-slate-400 font-medium"},te={class:"px-6 py-4 min-w-[200px]"},se=["title"],ae={class:"text-[10px] font-black uppercase tracking-widest text-indigo-500"},le={class:"px-6 py-4"},oe={class:"px-6 py-4"},re=["title"],de={class:"px-6 py-4 max-w-[220px]"},ie=["title"],ne={key:1,class:"text-[11px] text-slate-300 italic"},ce={class:"px-6 py-4"},pe={class:"px-6 py-4 text-right"},ue={class:"px-8 py-6 bg-slate-50 border-t border-slate-100"},xe={__name:"Index",props:{logs:Object,filters:Object,users:Array,stats:Object,modules:Array,actionTypes:Array},setup(xe){const be=xe,ge=e(be.filters.search),ve=e(be.filters.user_id||""),fe=e(be.filters.module||""),me=e(be.filters.action_type||""),he=e(be.filters.severity||""),we=e(be.filters.date_from||""),ye=e(be.filters.date_to||""),ke=y(()=>{t.get(route("audit.index"),{search:ge.value,user_id:ve.value,module:fe.value,action_type:me.value,severity:he.value,date_from:we.value,date_to:ye.value},{preserveState:!0,preserveScroll:!0,replace:!0})},300);s([ge,ve,fe,me,he,we,ye],()=>{ke()});const _e=e=>{switch(e){case"critical":return"bg-rose-100 text-rose-700 border-rose-200";case"warning":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},je=()=>{ge.value="",ve.value="",fe.value="",me.value="",he.value="",we.value="",ye.value=""},Ae=()=>{confirm("Are you sure you want to cleanup logs older than 6 months?")&&t.post(route("audit.cleanup"),{months:6})};return(e,t)=>(a(),l(p,null,[o(r(d),{title:"System Audit Center"}),o(h,null,{header:i(()=>[n("div",k,[t[9]||(t[9]=n("h2",{class:"text-2xl font-black text-slate-800 tracking-tight"},"Enterprise Audit Center",-1)),n("div",_,[n("a",{href:e.route("audit.export"),class:"inline-flex items-center px-4 py-2 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-700 uppercase tracking-widest shadow-sm hover:bg-slate-50 transition-all"},[...t[7]||(t[7]=[n("svg",{class:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),m(" Export CSV ",-1)])],8,j),n("button",{onClick:Ae,class:"inline-flex items-center px-4 py-2 bg-rose-50 border border-rose-100 rounded-xl text-xs font-bold text-rose-600 uppercase tracking-widest shadow-sm hover:bg-rose-100 transition-all"},[...t[8]||(t[8]=[n("svg",{class:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),m(" Cleanup Old Logs ",-1)])])])])]),default:i(()=>[n("div",A,[n("div",C,[n("div",U,[t[10]||(t[10]=n("div",{class:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1"},"Logs Today",-1)),n("div",S,c(xe.stats.total_today),1)]),n("div",M,[t[11]||(t[11]=n("div",{class:"text-amber-500 text-[10px] font-bold uppercase tracking-widest mb-1"},"Warnings Today",-1)),n("div",V,c(xe.stats.warnings_today),1)]),n("div",T,[t[12]||(t[12]=n("div",{class:"text-rose-500 text-[10px] font-bold uppercase tracking-widest mb-1"},"Critical Alerts",-1)),n("div",B,c(xe.stats.critical_today),1)]),n("div",L,[t[13]||(t[13]=n("div",{class:"text-indigo-500 text-[10px] font-bold uppercase tracking-widest mb-1"},"Top Modules",-1)),n("div",D,[(a(!0),l(p,null,u(xe.stats.modules,e=>(a(),l("span",{key:e.module,class:"px-2 py-1 bg-indigo-50 text-indigo-600 text-[9px] font-bold rounded-lg break-all"},c(e.module),1))),128))])])]),n("div",F,[n("div",O,[n("div",z,[t[14]||(t[14]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"Search Keywords",-1)),x(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>ge.value=e),type:"text",placeholder:"User, IP, Module...",class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,ge.value]])]),n("div",I,[t[16]||(t[16]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"Filter User",-1)),x(n("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>ve.value=e),class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},[t[15]||(t[15]=n("option",{value:""},"All Users",-1)),(a(!0),l(p,null,u(xe.users,e=>(a(),l("option",{key:e.id,value:e.id},c(e.name),9,E))),128))],512),[[g,ve.value]])]),n("div",P,[t[18]||(t[18]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"Module",-1)),x(n("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>fe.value=e),class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},[t[17]||(t[17]=n("option",{value:""},"All Modules",-1)),(a(!0),l(p,null,u(xe.modules,e=>(a(),l("option",{key:e,value:e},c(e),9,R))),128))],512),[[g,fe.value]])]),n("div",W,[t[20]||(t[20]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"Severity",-1)),x(n("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>he.value=e),class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},[...t[19]||(t[19]=[n("option",{value:""},"All Levels",-1),n("option",{value:"info"},"Info",-1),n("option",{value:"warning"},"Warning",-1),n("option",{value:"critical"},"Critical",-1)])],512),[[g,he.value]])])]),n("div",$,[n("div",H,[t[22]||(t[22]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"Action Type",-1)),x(n("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>me.value=e),class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},[t[21]||(t[21]=n("option",{value:""},"All Actions",-1)),(a(!0),l(p,null,u(xe.actionTypes,e=>(a(),l("option",{key:e,value:e},c(e.replace("_"," ").toUpperCase()),9,K))),128))],512),[[g,me.value]])]),n("div",q,[t[23]||(t[23]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"From Date",-1)),x(n("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>we.value=e),type:"date",class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,we.value]])]),n("div",G,[t[24]||(t[24]=n("label",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"To Date",-1)),x(n("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>ye.value=e),type:"date",class:"w-full text-sm border-slate-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,ye.value]])]),n("div",{class:"flex items-end"},[n("button",{onClick:je,class:"w-full h-[42px] bg-slate-100 text-[10px] font-black uppercase tracking-widest text-slate-500 rounded-xl hover:bg-slate-200 transition-all"}," Reset Filters ")])])]),n("div",J,[n("div",N,[n("table",Q,[t[26]||(t[26]=n("thead",null,[n("tr",{class:"bg-slate-50 border-b border-slate-100 text-[10px] font-black uppercase tracking-widest text-slate-400"},[n("th",{class:"px-6 py-4"},"Timestamp"),n("th",{class:"px-6 py-4"},"User / Role"),n("th",{class:"px-6 py-4"},"Action"),n("th",{class:"px-6 py-4"},"Module"),n("th",{class:"px-6 py-4"},"Context"),n("th",{class:"px-6 py-4"},"Status"),n("th",{class:"px-6 py-4 text-right"},"Details")])],-1)),n("tbody",X,[(a(!0),l(p,null,u(xe.logs.data,s=>{return a(),l("tr",{key:s.id,class:"hover:bg-slate-50/50 transition-colors group"},[n("td",Y,[n("div",Z,c((p=s.created_at,new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),1),n("div",ee,c(s.ip_address),1)]),n("td",te,[n("div",{class:"text-[14px] font-bold text-slate-800 content-protect text-truncate-2",title:s.user_name},c(s.user_name),9,se),n("div",ae,c(s.role),1)]),n("td",le,[n("span",{class:v(["px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-tighter border whitespace-nowrap",_e(s.severity)])},c(s.action_type.replace("_"," ")),3)]),n("td",oe,[n("span",{class:"text-[12px] font-bold text-slate-600 content-protect",title:s.module},c(s.module),9,re)]),n("td",de,[s.auditable_type?(a(),l("div",{key:0,class:"text-[11px] font-medium text-slate-500 content-protect text-truncate-2",title:`${s.auditable_type} #${s.auditable_id}`},c(s.auditable_type.split("\\").pop())+" #"+c(s.auditable_id),9,ie)):(a(),l("div",ne,"System Action"))]),n("td",ce,[n("span",{class:v(["px-2 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest whitespace-nowrap",(d=s.status,"success"===d?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700")])},c(s.status),3)]),n("td",pe,[o(r(f),{href:e.route("audit.show",s.id),class:"inline-flex h-8 w-8 items-center justify-center rounded-lg bg-white border border-slate-200 text-slate-400 hover:text-indigo-600 hover:border-indigo-100 transition-all shadow-sm"},{default:i(()=>[...t[25]||(t[25]=[n("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:1},8,["href"])])]);var d,p}),128))])])]),n("div",ue,[o(w,{links:xe.logs.links},null,8,["links"])])])])]),_:1})],64))}};export{xe as default};
